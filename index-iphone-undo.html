<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Kalkulaƒçka j√≠del ‚Äì iPhone COLOR+UNDO (UNDO)</title>
  <style>
    :root {
      --bg:#0b0f19; --text:#e5e7eb; --muted:#94a3b8;
      --ring:#3b4a66; --btn-bg1:#2a364d; --btn-bg2:#1a2235;
      --danger:#ef4444; --danger-d:#dc2626;
    }
    html, body { height:100%; }
    body {
      margin:0; font-family:-apple-system,BlinkMacSystemFont,Roboto,Arial;
      background:var(--bg); color:var(--text);
      display:flex; flex-direction:column;
    }
    .container { flex:1; padding:12px; max-width:1200px; margin:0 auto; width:100%; }
    .grid { display:grid; gap:16px; grid-template-columns:repeat(2,1fr); }
    h3{ margin:12px 4px 8px; font-size:14px; color:var(--muted); text-transform:uppercase; letter-spacing:.06em; }
    button.item {
      position:relative; padding:14px; border-radius:16px;
      background:linear-gradient(180deg,var(--btn-bg1),var(--btn-bg2));
      border:1px solid var(--ring); color:var(--text);
      font-size:16px; font-weight:700; text-align:left;
      -webkit-tap-highlight-color: transparent;
      transition: transform .08s ease, box-shadow .12s ease, border-color .12s ease;
    }
    button.item:active{ transform:scale(.98); }
    .price{ margin-top:4px; font-size:13px; color:var(--muted); font-weight:600; }
    .footer{
      position:sticky; bottom:0; background:#0b1220; padding:12px 14px;
      display:flex; justify-content:space-between; align-items:center; gap:16px;
      border-top:1px solid var(--ring);
    }
    .value{ font-size:18px; font-weight:800; }
    .actions{ display:flex; gap:14px; align-items:center; }
    .btn{
      padding:10px 14px; border-radius:12px; border:1px solid transparent;
      font-weight:700; cursor:pointer; color:#e5e7eb; background:#1e293b; border-color:#334155;
    }
    .btn:active{ transform:scale(.98); }
    .btn-undo{ background:#0f172a; border-color:#475569; }
    .btn-clear{ background:var(--danger); border-color:var(--danger); color:#fff; }
    .btn-clear:active{ background:var(--danger-d); border-color:var(--danger-d); }
    @keyframes flash {
      0%{box-shadow:0 0 0 0 rgba(239,68,68,.0); border-color:var(--ring);}
      30%{box-shadow:0 0 0 10px rgba(239,68,68,.28); border-color:#ef4444;}
      100%{box-shadow:0 0 0 0 rgba(239,68,68,.0); border-color:var(--ring);}
    }
    .flash { animation: flash .28s ease; }
    .badge {
      position:absolute; right:12px; top:12px;
      min-width:22px; height:22px; padding:0 6px; border-radius:999px;
      background:#22c55e; color:#0b1220;
      font-size:13px; font-weight:800; display:none; align-items:center; justify-content:center;
    }
    .badge.show { display:inline-flex; }
  </style>
</head>
<body>
  <div class="container">
    <h3>Pol√©vky</h3><div id="soups" class="grid"></div>
    <h3>Hlavn√≠ j√≠dla</h3><div id="mains" class="grid"></div>
    <h3>Boxy</h3><div id="boxes" class="grid"></div>
  </div>
  <div class="footer">
    <div>Souƒçet: <span class="value" id="total">0 Kƒç</span></div>
    <div class="actions">
      <button class="btn btn-undo" id="undoBtn" aria-label="Zpƒõt posledn√≠ polo≈æka">‚Ü©Ô∏é Zpƒõt</button>
      <button class="btn btn-clear" id="clearBtn" aria-label="Vymazat souƒçet">Vymazat</button>
    </div>
  </div>
<script>
const MENU = {
  soups: [
    { name: "Gul√°≈°ov√°", price: 50 },
    { name: "V√Ωvar", price: 30 }
  ],
  mains: [
    { name: "Vep≈ôov√Ω ≈ô√≠zek", price: 150 },
    { name: "Ku≈ôec√≠ ≈ô√≠zek", price: 150 },
    { name: "Sv√≠ƒçkov√°", price: 180 },
    { name: "≈†panƒõlsk√Ω pt√°ƒçek", price: 190 },
    { name: "Moravsk√Ω vrabec", price: 160 },
    { name: "Plnƒõn√Ω knedl√≠k", price: 150 },
    { name: "Brambor√°k", price: 50 },
    { name: "Buchtiƒçky", price: 90 }
  ],
  boxes: [
    { name: "üçú Box pol√©vka", price: 5 },
    { name: "üçó Box j√≠dlo", price: 10 }
  ]
};
const fmt = new Intl.NumberFormat('cs-CZ',{style:'currency',currency:'CZK',maximumFractionDigits:0});
let total=0;
const counts = {};    // map: key -> count
const history = [];     // z√°sobn√≠k posledn√≠ch klik≈Ø {key, price}

function updateTotal(){ document.getElementById('total').textContent = fmt.format(total); }

function updateBadge(key){
  const bd = document.getElementById('badge-'+key);
  if(!bd) return;
  const v = counts[key]||0;
  if(v>0){ bd.textContent = v; bd.classList.add('show'); }
  else   { bd.textContent = '0'; bd.classList.remove('show'); }
}

function buttonFor(item,key){
  const b=document.createElement('button');
  b.className='item';
  counts[key]=0;
  b.innerHTML=`<div>${item.name}</div><div class='price'>${fmt.format(item.price)}</div><span class="badge" id="badge-${key}">0</span>`;
  b.onclick=()=>{
    total+=item.price; updateTotal();
    counts[key] = (counts[key]||0) + 1; updateBadge(key);
    history.push({key: key, price:item.price});
    b.classList.remove('flash'); void b.offsetWidth; b.classList.add('flash');
    try{ if(navigator.vibrate) navigator.vibrate(8); }catch(e){}
  };
  return b;
}

function renderSection(id,arr,prefix){
  const el=document.getElementById(id); el.innerHTML='';
  arr.forEach((item,i)=>el.appendChild(buttonFor(item,prefix+'-'+i)));
}

function render(){
  renderSection('soups',MENU.soups,'soups');
  renderSection('mains',MENU.mains,'mains');
  renderSection('boxes',MENU.boxes,'boxes');
  updateTotal();
}

document.getElementById('clearBtn').onclick=()=>{
  total=0; updateTotal();
  Object.keys(counts).forEach(k=>{ counts[k]=0; updateBadge(k); });
  history.length = 0;
};

document.getElementById('undoBtn').onclick=()=>{
  if(history.length===0) return;
  const last = history.pop();
  total = Math.max(0, total - last.price);
  updateTotal();
  if(counts[last.key]) counts[last.key] = Math.max(0, counts[last.key]-1);
  updateBadge(last.key);
  try{ if(navigator.vibrate) navigator.vibrate([10,40,10]); }catch(e){}
};

render();
</script>
</body>
</html>